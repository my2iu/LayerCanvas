<!doctype html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name = "viewport" content = "user-scalable=no, initial-scale=1">
    <link type="text/css" rel="stylesheet" href="LayerCanvas.css">
    <title>Layer Canvas</title>

    <script>
    	<!-- Code for the LayerCanvas is available at https://github.com/my2iu/LayerCanvas --> 
    
    	var layercanvas1;
    	var layercanvas2;
    	function onGwtLoaded()
    	{
    		// Grab references to the canvas and div around the canvas
    		// (since there's an image sitting overtop the canvas, the canvas
    		// won't receive events, so instead we grab events at the parent div)
			var div1 = document.querySelector("#divcanvas1");
			var canvas1 = div1.querySelectorAll("canvas");
			layercanvas1 = org.programmingbasics.layercanvas.LayerCanvas.createUi(div1, canvas1[0], canvas1[1]);

			// Ditto for additional canvases
			var div2 = document.querySelector("#divcanvas2");
			var canvas2 = div2.querySelectorAll("canvas");
			layercanvas2 = org.programmingbasics.layercanvas.LayerCanvas.createUi(div2, canvas2[0], canvas2[1]);
			
			// Set initial brush sizes etc.
			layercanvas1.setBrushSize(5);
			layercanvas2.setBrushSize(5);

			// Enable horizontal mirroring for the main canvas to demonstrate it
			layercanvas1.setMirrorMode(true);
    	}
    	
    </script>
    <script type="text/javascript" language="javascript" src="layercanvas/layercanvas.nocache.js"></script>
    
    <script>
    	// Just some example glue code to wire up the various buttons to the canvas
    	function brushChosen(e,size) {
    		e.preventDefault();
    		
			layercanvas1.setBrushSize(size);
			layercanvas1.paintMode();    		

			layercanvas2.setBrushSize(size);
			layercanvas2.paintMode();    		
    	}
    	
    	function eraserChosen(e,size) {
    		e.preventDefault();
    		
			layercanvas1.setBrushSize(size);
			layercanvas1.eraserMode();    		

			layercanvas2.setBrushSize(size);
			layercanvas2.eraserMode();    		
    	}
    	
    	function copyTopPictureToBottom() {
    		// Demonstrates how to extract or load in PNG data using data URLs, which can be passed around as strings 
			var data = layercanvas1.extractPngDataUrl();
			layercanvas2.clear();
			layercanvas2.loadInPngDataUrl(data)
    	}
    	
    	function copyBottomPictureToTop() {
    		// Demonstrates how to extract or load in PNG data using arraybuffers, which can be passed around as binary data using XMLHttpRequest 
			layercanvas2.extractPngArrayBuffer( function(arraybuffer) {
			
			
				// We have the arraybuffer. Load it into other canvas
				layercanvas1.clear();
				layercanvas1.loadInPngArrayBuffer(arraybuffer);
				
				
			});
    	}
    </script>
    
  </head>

  <body>
  	<!-- Arrange the overlay image and canvas inside a div like shown here -->
  	<!-- The div, canvas, and image should all have the same width and height -->
  	<!-- Here, the div has position: relative, but absolute is also fine -->
  	<!-- Note that TWO canvases are needed for the layer canvas -->
  	<div style="position: relative; width: 500px; height: 300px;" id="divcanvas1">
  		<canvas width="500" height="300" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0;"></canvas>
  		<canvas width="500" height="300" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0;"></canvas>
  		<img src="overlay.png" draggable="false" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; user-select: none; -webkit-user-select: none;">
  	</div>
  	
  	<div style="display: flex; justify-content: space-between;">
  		<a href="#" onclick="brushChosen(event, 20)">Big Brush</a> 
  		<a href="#" onclick="brushChosen(event, 10)">Medium Brush</a>
  		<a href="#" onclick="brushChosen(event, 5)">Little Brush</a>
  		<a href="#" onclick="eraserChosen(event, 20)">Big Eraser</a> 
  		<a href="#" onclick="eraserChosen(event, 10)">Medium Eraser</a>
  		<a href="#" onclick="eraserChosen(event, 5)">Little Eraser</a>
  		<a href="#" onclick="copyTopPictureToBottom()">Copy top picture to bottom</a>
  		<a href="#" onclick="copyBottomPictureToTop()">Copy bottom picture to top</a>
  	</div>
  	
  	<!-- Here's a second canvas to show that two different drawings can be handled at once -->
  	<div style="position: relative; width: 700px; height: 300px;" id="divcanvas2">
  		<canvas width="700" height="300" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0;"></canvas>
  		<canvas width="700" height="300" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0;"></canvas>
  		<img src="overlaywide.png" draggable="false" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; user-select: none; -webkit-user-select: none;">
  	</div>
  	
  	
  </body>
</html>
